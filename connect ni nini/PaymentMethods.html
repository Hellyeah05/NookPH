<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Payment Methods - Nook PH</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="ecommcss.css">

  <style>
    .sub-nav-link {
      font-weight: 800;
      text-decoration: none;
      color: black;
      text-transform: uppercase;
      font-size: 0.9rem;
    }
    .sub-nav-link:hover {
      text-decoration: underline;
    }

    .profile-sidebar {
      padding-right: 20px;
      border-right: 1px solid #ddd;
      min-height: 400px;
    }

    .sidebar-item {
      display: flex;
      align-items: center;
      padding: 15px 20px;
      font-weight: 700;
      color: black;
      text-decoration: none;
      margin-bottom: 10px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1.1rem;
    }

    .sidebar-item.active {
      background-color: #fcd5d9;
    }

    .sidebar-item:hover {
    background-color: #F8D9D9; 
    color: #000;
    padding-left: 8px; 
  }

    .sidebar-icon {
      margin-right: 15px;
      font-size: 1.3rem;
    }

    .profile-content {
      padding-left: 40px;
    }

    .avatar-section {
      text-align: center;
      margin-bottom: 40px;
    }

    .avatar-circle {
      width: 100px;
      height: 100px;
      background-color: black;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
    }
    
    .avatar-icon {
      color: white;
      font-size: 3.5rem;
    }

    .btn-select-image {
      background-color: white;
      border: 1px solid #ccc;
      color: black;
      font-weight: 700;
      text-transform: uppercase;
      padding: 8px 20px;
      font-size: 0.85rem;
    }

    .form-group {
      margin-bottom: 25px;
    }

    .input-label {
      font-weight: 600;
      color: #555;
      text-transform: uppercase;
      font-size: 0.9rem;
      margin-bottom: 5px;
      display: block;
    }

    .custom-input {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-weight: 700;
      color: black;
      font-size: 1rem;
    }

    .change-link {
      float: right;
      color: #d9534f;
      text-decoration: underline;
      font-size: 0.85rem;
      cursor: pointer;
      margin-top: -30px;
      position: relative;
      top: -5px;
      right:-50px;
    }

    /* === PAYMENT CONTENT === */
    .profile-content { padding-left: 40px; padding-top: 10px; }
    
    .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; margin-top: 30px; }
    .section-header h3 { font-weight: 800; font-size: 1.4rem; margin: 0; color: black; }
    
    .btn-add-method { background-color: #4d0000; color: white; border: none; border-radius: 30px; padding: 8px 20px; font-weight: 700; font-size: 0.9rem; }
    .btn-add-method:hover { background-color: #330000; color: white; }

    /* Payment List Items */
    .payment-item { 
        display: flex; 
        align-items: center; 
        justify-content: space-between; 
        padding: 20px 0; 
        border-bottom: 1px solid #ddd; 
    }
    
    .payment-info { display: flex; align-items: center; gap: 20px; }
    .payment-icon { font-size: 1.5rem; color: #333; }
    .payment-name { font-weight: 700; font-size: 1rem; }
    .payment-subtext { color: #666; font-size: 0.9rem; letter-spacing: 1px; }

    .default-badge { 
        border: 1px solid #000; 
        font-size: 0.7rem; 
        padding: 2px 6px; 
        font-weight: 600; 
        text-transform: uppercase; 
        margin-left: 10px;
    }
    .default-badge.hidden { display: none; }

    .payment-actions { display: flex; align-items: center; gap: 15px; }
    .link-delete { color: #d9534f; text-decoration: underline; font-size: 0.85rem; cursor: pointer; }
    
    .btn-set-default { background: white; border: 1px solid #ccc; color: #666; font-size: 0.75rem; padding: 4px 10px; cursor: pointer; }
    .btn-set-default:hover { border-color: black; color: black; }
    .btn-set-default.disabled { opacity: 0.5; cursor: default; pointer-events: none; }

    /* Empty State */
    .empty-state { text-align: center; color: #888; font-size: 1rem; padding: 40px 0; }

    /* === MODAL STYLES (Fixed Background) === */
    .modal { z-index: 2000 !important; }
    .modal-backdrop { z-index: 1999 !important; background-color: rgba(0, 0, 0, 0.7) !important; }
    .modal-content { background-color: #ffffff !important; border: none; border-radius: 10px; }
    .modal-header { background-color: #4d0000; color: white; border-top-left-radius: 10px; border-top-right-radius: 10px; }
    .btn-close-white { filter: invert(1); }
    .modal-body { background-color: #ffffff !important; padding: 20px; }
    .modal-body .form-label { color: #333; font-weight: 700; font-size: 0.9rem; margin-bottom: 5px; }
    .modal-body .form-control { background-color: #fff !important; border: 1px solid #ccc !important; color: #000 !important; border-radius: 5px; margin-bottom: 15px; padding: 10px; }
    .modal-body .form-control:focus { border-color: #4d0000 !important; box-shadow: 0 0 5px rgba(77, 0, 0, 0.2); }
    .modal-footer { background-color: #ffffff !important; border-top: 1px solid #eee; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; }

  </style>
</head>

<body>

  <!-- TOP BAR -->
  <div class="top-bar">
    <div class="container-fluid d-flex justify-content-end gap-4 px-4">
      <a href="web2.html">HOME</a>
      <a href="#" data-bs-toggle="modal" data-bs-target="#aboutModal">ABOUT</a>
      <a href="#">ORDERS</a>
      <a href="#">HELP</a>
      <a href="#">EXPLORE</a>
    </div>
  </div>

  <!-- NAVBAR -->
  <nav class="navbar main-navbar shadow" >
    <div class="container-fluid d-flex justify-content-between align-items-center px-4">
      <a href="eComm.html" class="navbar-brand">
        <img src="LOGO.png" alt="Logo" class="logo-img">
      </a>
      <form class="search-wrapper mx-auto">
        <input type="search" class="search-input" placeholder="Search Books, Authors, and Genres">
        <i class="bi bi-search search-icon"></i>
      </form>
      <div class="navbar-actions">
        <i class="bi bi-heart icon-btn"></i>
        <i class="bi bi-cart icon-btn"></i>
      </div>
    </div>
  </nav>

  <!-- SUB HEADER -->
  <div class="container mt-4 mb-4">
    <div class="d-flex justify-content-between align-items-center">
      <a href="eComm.html" class="sub-nav-link">BACK</a>
      <a href="eComm.html" class="sub-nav-link">CONTINUE SHOPPING</a>
    </div>
  </div>

  <!-- MAIN LAYOUT -->
  <div class="container">
    <div class="row">
      
      <!-- SIDEBAR -->
      <div class="col-md-3">
        <div class="profile-sidebar">
          <a href="Profile.html" class="sidebar-item">
            <i class="bi bi-person-fill sidebar-icon"></i> Profile
          </a>
          <a href="Notification.html" class="sidebar-item">
            <i class="bi bi-envelope-fill sidebar-icon"></i> Notifications
          </a>
          <a href="ShippingAddress.html" class="sidebar-item">
            <i class="bi bi-geo-alt-fill sidebar-icon"></i> Shipping Address
          </a>
          <!-- Active Tab -->
          <div class="sidebar-item active">
            <i class="bi bi-wallet-fill sidebar-icon"></i> Payment Methods
          </div>
          <div class="sidebar-item mt-5" id="logoutBtn" style="cursor: pointer;">
            <i class="bi bi-box-arrow-right sidebar-icon"></i> Logout
          </div>
        </div>
      </div>

      <!-- MAIN CONTENT -->
      <div class="col-md-9 profile-content">
        
        <!-- SECTION 1: CARDS -->
        <div class="section-header" style="margin-top: 0;">
            <h3>Credit/Debit Card</h3>
            <button class="btn btn-add-method" data-bs-toggle="modal" data-bs-target="#cardModal">+ Add New Card</button>
        </div>
        
        <hr style="color: #ccc; margin-top: 0;">

        <div id="cardsList">
            <!-- Default Card Example -->
            <div class="payment-item" id="card-default">
                <div class="payment-info">
                    <i class="bi bi-credit-card-2-front payment-icon"></i>
                    <div>
                        <span class="payment-name">Master Card</span>
                        <span class="default-badge">Default</span>
                    </div>
                    <span class="payment-subtext">**** **** **** 9099</span>
                </div>
                <div class="payment-actions">
                    <span class="link-delete" onclick="deleteItem('card-default')">Delete</span>
                    <button class="btn-set-default disabled">Set as Default</button>
                </div>
            </div>
        </div>

        <!-- SECTION 2: BANK ACCOUNTS -->
        <div class="section-header">
            <h3>My Bank Account</h3>
            <button class="btn btn-add-method" data-bs-toggle="modal" data-bs-target="#bankModal">+ Add New Bank Account</button>
        </div>
        
        <hr style="color: #ccc; margin-top: 0;">

        <div id="bankList">
            <!-- Empty State -->
            <div id="bankEmptyState" class="empty-state">
                You don't have any linked bank accounts yet.
            </div>
        </div>

      </div>
    </div>
  </div>

  <!-- MODAL: ADD CARD -->
  <div class="modal fade" id="cardModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add New Card</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="cardForm">
            <label class="form-label">Card Number</label>
            <input type="text" class="form-control" id="inputCardNum" placeholder="0000 0000 0000 0000" maxlength="19" required>
            
            <label class="form-label">Name on Card</label>
            <input type="text" class="form-control" id="inputCardName" placeholder="JUAN DELA CRUZ" required>
            
            <div class="row">
                <div class="col-6">
                    <label class="form-label">Expiry Date</label>
                    <input type="text" class="form-control" id="inputExpiry" placeholder="MM/YY" required>
                </div>
                <div class="col-6">
                    <label class="form-label">CVV</label>
                    <input type="text" class="form-control" id="inputCVV" placeholder="123" maxlength="3" required>
                </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" style="background-color: #4d0000;" onclick="saveCard()">Save Card</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: ADD BANK -->
  <div class="modal fade" id="bankModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Link Bank Account</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="bankForm">
            <label class="form-label">Bank Name</label>
            <input type="text" class="form-control" id="inputBankName" placeholder="e.g. BDO, BPI" required>
            
            <label class="form-label">Account Number</label>
            <input type="text" class="form-control" id="inputBankNum" placeholder="Account Number" required>
            
            <label class="form-label">Account Holder Name</label>
            <input type="text" class="form-control" id="inputBankHolder" placeholder="Full Name" required>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" style="background-color: #4d0000;" onclick="saveBank()">Link Account</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ABOUT MODAL -->
  <div class="modal fade" id="aboutModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="red-popup-box" style="background-color: #4d0000; color: white; padding: 40px; text-align: center; border-radius: 15px;">
          <h2>About Us</h2>
          <p>Welcome to Nook PH.</p>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const cardModal = new bootstrap.Modal(document.getElementById('cardModal'));

    function saveCard() {
        const num = document.getElementById('inputCardNum').value;
        const name = document.getElementById('inputCardName').value;
        
        if(!num || !name) { alert("Please fill details"); return; }

        const last4 = num.slice(-4) || "0000";
        const newId = 'card-' + new Date().getTime();

        const html = `
        <div class="payment-item" id="${newId}">
            <div class="payment-info">
                <i class="bi bi-credit-card-2-front payment-icon"></i>
                <div>
                    <span class="payment-name">Credit/Debit Card</span>
                    <span class="default-badge hidden">Default</span>
                </div>
                <span class="payment-subtext">**** **** **** ${last4}</span>
            </div>
            <div class="payment-actions">
                <span class="link-delete" onclick="deleteItem('${newId}')">Delete</span>
                <button class="btn-set-default" onclick="setDefault('${newId}')">Set as Default</button>
            </div>
        </div>`;

        document.getElementById('cardsList').insertAdjacentHTML('beforeend', html);
        cardModal.hide();
        document.getElementById('cardForm').reset();
    }

    const bankModal = new bootstrap.Modal(document.getElementById('bankModal'));

    function saveBank() {
        const bankName = document.getElementById('inputBankName').value;
        const bankNum = document.getElementById('inputBankNum').value;

        if(!bankName) { alert("Please fill details"); return; }

        const emptyState = document.getElementById('bankEmptyState');
        if(emptyState) emptyState.remove();

        const newId = 'bank-' + new Date().getTime();
        const html = `
        <div class="payment-item" id="${newId}">
            <div class="payment-info">
                <i class="bi bi-bank payment-icon"></i>
                <div>
                    <span class="payment-name">${bankName}</span>
                </div>
                <span class="payment-subtext">${bankNum}</span>
            </div>
            <div class="payment-actions">
                <span class="link-delete" onclick="deleteItem('${newId}')">Delete</span>
            </div>
        </div>`;

        document.getElementById('bankList').insertAdjacentHTML('beforeend', html);
        bankModal.hide();
        document.getElementById('bankForm').reset();
    }

    function deleteItem(id) {
        if(confirm("Remove this payment method?")) {
            document.getElementById(id).remove();
        }
    }

    function setDefault(id) {
        document.querySelectorAll('#cardsList .payment-item').forEach(item => {
            item.querySelector('.default-badge').classList.add('hidden');
            item.querySelector('.btn-set-default').classList.remove('disabled');
        });

        const target = document.getElementById(id);
        target.querySelector('.default-badge').classList.remove('hidden');
        target.querySelector('.btn-set-default').classList.add('disabled');
    }

    document.getElementById('logoutBtn').addEventListener('click', function() {
        if(confirm("Are you sure you want to Log Out?")) {
            localStorage.setItem('isLoggedIn', 'false');
            window.location.href = "eComm.html"; 
        }
    });
  </script>

</body>
</html>